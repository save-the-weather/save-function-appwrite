import { Client, Databases, ID } from 'node-appwrite';

// This Appwrite function will be executed every time your function is triggered
export default async ({ req, res, log, error }) => {
  // You can use the Appwrite SDK to interact with other services
  // For this example, we're using the Users service
  const client = new Client()
    .setEndpoint(process.env.APPWRITE_FUNCTION_API_ENDPOINT)
    .setProject(process.env.APPWRITE_FUNCTION_PROJECT_ID)
    .setKey(req.headers['x-appwrite-key'] ?? '');
  const key = process.env.OPENWEATHERMAP_KEY;
  const locations = [
    [35.6839, 139.7744, "Tokyo, Japan"],
    [-6.2146, 106.8451, "Jakarta, Indonesia"],
    [28.6667, 77.2167, "Delhi, India"],
    [14.6000, 120.9833, "Manila, Philippines"],
    [-23.5504, -46.6339, "São Paulo, Brazil"],
    /*[37.5600, 126.9900, "Seoul, South Korea"],
    [19.0758, 72.8775, "Mumbai, India"],
    [31.1667, 121.4667, "Shanghai, China"],
    [19.4333, -99.1333, "Mexico City, Mexico"],
    [23.1288, 113.2590, "Guangzhou, China"],
    [30.0444, 31.2358, "Cairo, Egypt"],
    [39.9040, 116.4075, "Beijing, China"],
    [40.6943, -73.9249, "New York, United States"],
    [22.5727, 88.3639, "Kolkāta, India"],
    [55.7558, 37.6178, "Moscow, Russia"],
    [13.7500, 100.5167, "Bangkok, Thailand"],
    [23.7289, 90.3944, "Dhaka, Bangladesh"],
    [-34.5997, -58.3819, "Buenos Aires, Argentina"],
    [34.7520, 135.4582, "Ōsaka, Japan"],
    [6.4500, 3.4000, "Lagos, Nigeria"],
    [41.0100, 28.9603, "Istanbul, Turkey"],
    [24.8600, 67.0100, "Karachi, Pakistan"],
    [-4.3317, 15.3139, "Kinshasa, Congo (Kinshasa)"],
    [22.5350, 114.0540, "Shenzhen, China"],
    [12.9791, 77.5913, "Bangalore, India"],
    [10.8167, 106.6333, "Ho Chi Minh City, Vietnam"],
    [35.7000, 51.4167, "Tehran, Iran"],
    [34.1139, -118.4068, "Los Angeles, United States"],
    [-22.9083, -43.1964, "Rio de Janeiro, Brazil"],
    [30.6600, 104.0633, "Chengdu, China"],
    [38.8671, 115.4845, "Baoding, China"],
    [13.0825, 80.2750, "Chennai, India"],
    [31.5497, 74.3436, "Lahore, Pakistan"],
    [51.5072, -0.1275, "London, United Kingdom"],
    [48.8566, 2.3522, "Paris, France"],
    [39.1467, 117.2056, "Tianjin, China"],
    [35.0606, 118.3425, "Linyi, China"],
    [38.0422, 114.5086, "Shijiazhuang, China"],
    [34.7492, 113.6605, "Zhengzhou, China"],
    [32.9987, 112.5292, "Nanyang, China"],
    [17.3617, 78.4747, "Hyderābād, India"],
    [30.5872, 114.2881, "Wuhan, China"],
    [36.6116, 114.4894, "Handan, China"],
    [35.1167, 136.9333, "Nagoya, Japan"],
    [36.7167, 119.1000, "Weifang, China"],
    [-12.0600, -77.0375, "Lima, Peru"],
    [33.6250, 114.6418, "Zhoukou, China"],
    [-8.8383, 13.2344, "Luanda, Angola"],
    [25.8292, 114.9336, "Ganzhou, China"],
    [34.2610, 117.1859, "Tongshan, China"],
    [3.1478, 101.6953, "Kuala Lumpur, Malaysia"],
    [41.8373, -87.6862, "Chicago, United States"],
    [35.2333, 115.4333, "Heze, China"],
    [29.5500, 106.5069, "Chongqing, China"],
    [21.0245, 105.8412, "Hanoi, Vietnam"],
    [32.8986, 115.8045, "Fuyang, China"],
    [28.1987, 112.9709, "Changsha, China"],
    [23.0475, 113.7493, "Dongguan, China"],
    [35.4000, 116.5667, "Jining, China"],
    [36.6667, 116.9833, "Jinan, China"],
    [18.5196, 73.8553, "Pune, India"],
    [23.0292, 113.1056, "Foshan, China"],
    [4.6126, -74.0705, "Bogotá, Colombia"],
    [32.0500, 118.7667, "Nanjing, China"],
    [23.0300, 72.5800, "Ahmedabad, India"],
    [43.9000, 125.2000, "Changchun, China"],
    [39.6292, 118.1742, "Tangshan, China"],
    [38.3037, 116.8452, "Cangzhou, China"],
    [-6.8000, 39.2833, "Dar es Salaam, Tanzania"],
    [31.8639, 117.2808, "Hefei, China"],
    [22.3069, 114.1831, "Hong Kong, Hong Kong"],
    [27.2418, 111.4725, "Shaoyang, China"],
    [21.1967, 110.4031, "Zhanjiang, China"],
    [34.4259, 115.6467, "Shangqiu, China"],
    [31.9829, 120.8873, "Nantong, China"],
    [33.3936, 120.1339, "Yancheng, China"],
    [22.8192, 108.3150, "Nanning, China"],
    [26.8968, 112.5857, "Hengyang, China"],
    [32.9773, 114.0253, "Zhumadian, China"],
    [41.8039, 123.4258, "Shenyang, China"],
    [37.0659, 114.4753, "Xingtai, China"],
    [34.2667, 108.9000, "Xi’an, China"],
    [-33.4500, -70.6667, "Santiago, Chile"],
    [37.3997, 121.2664, "Yantai, China"],
    [24.6500, 46.7100, "Riyadh, Saudi Arabia"],
    [34.6587, 112.4245, "Luoyang, China"],
    [25.0433, 102.7061, "Kunming, China"],
    [28.4419, 117.9633, "Shangrao, China"],
    [30.2500, 120.1675, "Hangzhou, China"],
    [27.3019, 105.2863, "Bijie, China"],
    [24.9139, 118.5858, "Quanzhou, China"],
    [25.7839, -80.2102, "Miami, United States"],
    [31.5667, 120.2833, "Wuxi, China"],
    [30.4500, 114.8750, "Huanggang, China"],
    [21.6618, 110.9178, "Maoming, China"],
    [30.7991, 106.0784, "Nanchong, China"],
    [27.7050, 106.9336, "Zunyi, China"],
    [25.5102, 103.8029, "Qujing, China"],
    [32.1264, 114.0672, "Xinyang, China"],
    [33.3500, 44.4167, "Baghdad, Iraq"],
    [23.5533, 116.3649, "Jieyang, China"],
    [15.6031, 32.5265, "Khartoum, Sudan"],
    [40.4167, -3.7167, "Madrid, Spain"],
    [25.4500, 81.8500, "Allahābād, India"],
    [22.6293, 110.1507, "Yulin, China"],
    [29.0397, 111.6839, "Changde, China"],
    [36.4500, 115.9833, "Liaocheng, China"],
    [36.1167, 120.4000, "Qingdao, China"],
    [32.7936, -96.7662, "Dallas, United States"],
    [35.2992, 113.8851, "Nangandao, China"],
    [32.0654, 112.1531, "Xiangyang, China"],
    [40.0077, -75.1339, "Philadelphia, United States"],
    [31.7542, 116.5078, "Lu’an, China"],
    [29.9870, 31.2118, "Giza, Egypt"],
    [27.3328, 103.7144, "Zhaotong, China"],
    [27.8041, 114.3830, "Yichun, China"],
    [37.4513, 116.3105, "Dezhou, China"],
    [28.6842, 115.8872, "Nanchang, China"],
    [-1.2864, 36.8172, "Nairobi, Kenya"],
    [36.2001, 117.0809, "Tai’an, China"],
    [31.2152, 107.4947, "Dazhou, China"],
    [29.7863, -95.3889, "Houston, United States"],
    [26.4515, 111.5953, "Yongzhou, China"],
    [33.7627, -84.4224, "Atlanta, United States"],
    [20.6767, -103.3475, "Guadalajara, Mexico"],
    [16.7950, 96.1600, "Rangoon, Myanmar"],
    [43.7417, -79.3733, "Toronto, Canada"],
    [46.6384, 126.9808, "Suihua, China"],
    [59.9500, 30.3167, "Saint Petersburg, Russia"],
    [38.9047, -77.0163, "Washington, United States"],
    [47.3398, 123.9512, "Qiqihar, China"],
    [33.6333, 116.9683, "Suzhou, China"],
    [23.3735, 116.6941, "Shantou, China"],
    [34.4996, 109.4684, "Weinan, China"],
    [31.8122, 119.9692, "Changzhou, China"],
    [1.3000, 103.8000, "Singapore, Singapore"],
    [26.0769, 119.2917, "Fuzhou, China"],
    [31.2231, 121.5397, "Pudong, China"],
    [-19.9281, -43.9419, "Belo Horizonte, Brazil"],
    [24.5093, 117.6612, "Zhangzhou, China"],
    [35.0304, 110.9980, "Yuncheng, China"],
    [31.3040, 120.6164, "Suzhou, China"],
    [34.3500, 108.7167, "Xianyang, China"],
    [25.2667, 110.2833, "Guilin, China"],
    [32.4831, 119.9000, "Taizhou, China"],
    [5.3364, -4.0267, "Abidjan, Côte d'Ivoire"],
    [27.5494, 109.9592, "Huaihua, China"],
    [27.1172, 114.9793, "Ji’an, China"],
    [30.9273, 113.9110, "Xiaoganzhan, China"],
    [33.7350, 113.2999, "Pingdingshan, China"],
    [29.7048, 116.0021, "Jiujiang, China"],
    [26.5794, 106.7078, "Guiyang, China"],
    [21.1700, 72.8300, "Sūrat, India"],
    [31.2000, 29.9167, "Alexandria, Egypt"],
    [33.8626, 115.7742, "Bozhou, China"],
    [-33.8650, 151.2094, "Sydney, Australia"],
    [23.1115, 114.4152, "Huizhou, China"],
    [33.5000, 119.1331, "Huai’an, China"],
    [25.7989, 113.0267, "Chenzhou, China"],
    [41.3825, 2.1769, "Barcelona, Spain"],
    [30.5000, 117.0333, "Anqing, China"],
    [33.9331, 118.2831, "Suqian, China"],
    [42.3188, -71.0846, "Boston, United States"],
    [22.5833, 113.0833, "Jiangmen, China"],
    [31.4669, 104.7385, "Mianyang, China"],
    [45.7500, 126.6333, "Harbin, China"],
    [34.7936, 114.3403, "Huanglongsi, China"],
    [36.7831, 118.0497, "Zibo, China"],
    [-37.8136, 144.9631, "Melbourne, Australia"],
    [38.9000, 121.6000, "Dalian, China"],
    [37.7348, 115.6860, "Hengshui, China"],
    [28.7596, 104.6400, "Yibin, China"],
    [32.3912, 119.4363, "Yangzhou, China"],
    [2.3528, -76.6819, "Timbío, Colombia"],
    [-26.2044, 28.0416, "Johannesburg, South Africa"],
    [28.5833, 112.3333, "Yiyang, China"],
    [23.0961, 109.6092, "Guigang, China"],
    [34.5906, 119.1801, "Xinpu, China"],
    [24.2998, 116.1191, "Meizhou, China"],
    [33.5992, -7.6200, "Casablanca, Morocco"],
    [39.5196, 116.7006, "Langfang, China"],
    [40.8108, 114.8811, "Zhangjiakou, China"],
    [42.2663, 118.9223, "Chifeng, China"],
    [36.0812, 111.5087, "Linfen, China"],
    [34.0244, 113.8201, "Jiangguanchi, China"],
    [34.5328, 69.1658, "Kabul, Afghanistan"],
    [33.5722, -112.0891, "Phoenix, United States"],
    [28.8918, 105.4409, "Luzhou, China"],
    [37.8733, 112.5425, "Taiyuan, China"],
    [23.0500, 112.4667, "Zhaoqing, China"],
    [30.7083, 111.2803, "Xiaoxita, China"],
    [24.4797, 118.0819, "Xiamen, China"],
    [27.9814, 116.3577, "Fuzhou, China"],
    [24.3264, 109.4281, "Liuzhou, China"],
    [27.8407, 113.1469, "Zhuzhou, China"],
    [31.9500, 35.9333, "Amman, Jordan"],
    [21.5428, 39.1728, "Jeddah, Saudi Arabia"],
    [32.3062, 118.3115, "Chuzhou, China"],
    [27.7378, 111.9974, "Loudi, China"],
    [31.1289, 104.3950, "Deyang, China"],
    [23.6842, 113.0507, "Qingyuan, China"],
    [12.0000, 8.5167, "Kano, Nigeria"],
    [31.3340, 118.3622, "Wuhu, China"],
    [47.6211, -122.3244, "Seattle, United States"],
    [35.4333, 139.6333, "Yokohama, Japan"],
    [37.3806, 118.0125, "Binzhou, China"],
    [34.3609, 107.1751, "Baojishi, China"],
    [34.8667, 117.5500, "Zaozhuang, China"],
    [29.5872, 105.0635, "Neijiang, China"],
    [23.9010, 106.6194, "Baicheng, China"],
    [52.5167, 13.3833, "Berlin, Germany"],
    [41.1066, 122.9895, "Anshan, China"],
    [36.0617, 103.8318, "Lanzhou, China"],
    [35.7639, 115.0300, "Puyang, China"],
    [37.7562, -122.4430, "San Francisco, United States"],
    [35.2290, 113.2304, "Jiaozuo, China"],
    [24.6928, 108.0850, "Hechi, China"],
    [45.5089, -73.5617, "Montréal, Canada"],
    [42.3834, -83.1024, "Detroit, United States"],
    [40.9739, 117.9322, "Chengde, China"],
    [35.1000, 129.0403, "Busan, South Korea"],
    [33.0794, 107.0260, "Hanzhong, China"],
    [36.7764, 3.0586, "Algiers, Algeria"],
    [32.6351, 110.7755, "Shiyan, China"],
    [43.1715, 124.3644, "Siping, China"],
    [26.8470, 80.9470, "Lucknow, India"],
    [38.2655, 109.7388, "Yulinshi, China"],
    [36.1953, 113.0970, "Changzhi, China"],
    [21.9500, 108.6167, "Qinzhou, China"],
    [31.8576, 106.7559, "Bazhou, China"],
    [34.5809, 105.7311, "Qincheng, China"],
    [22.5333, 113.3500, "Zhongshan, China"],
    [30.5098, 105.5737, "Suining, China"],
    [29.5854, 103.7575, "Leshan, China"],
    [32.8312, -117.1225, "San Diego, United States"],
    [30.4673, 106.6336, "Guang’an, China"],
    [31.4180, 73.0790, "Faisalabad, Pakistan"],
    [27.7233, 109.1885, "Tongren, China"],
    [32.9354, 117.3531, "Bengbu, China"],
    [-17.7892, -63.1975, "Santa Cruz, Bolivia"],
    [39.9398, 119.5881, "Qinhuangdao, China"],
    [43.6172, 122.2640, "Tongliao, China"],
    [41.1144, 121.1292, "Jinzhou, China"],
    [32.2109, 119.4551, "Zhenjiang, China"],
    [43.8225, 87.6125, "Ürümqi, China"],
    [23.7503, 114.6923, "Heyuan, China"],
    [26.9167, 75.8667, "Jaipur, India"],
    [38.4178, 112.7233, "Xinzhou, China"],
    [23.4833, 111.3167, "Wuzhou, China"],
    [41.5757, 120.4486, "Chaoyang, China"],
    [9.0272, 38.7369, "Addis Ababa, Ethiopia"],
    [-15.7939, -47.8828, "Brasília, Brazil"],
    [36.3069, 59.6042, "Mashhad, Iran"],
    [24.8011, 113.5927, "Shaoguan, China"],
    [22.7664, 115.3331, "Shanwei, China"],
    [29.3750, 47.9800, "Kuwait City, Kuwait"],
    [44.9635, -93.2678, "Minneapolis, United States"],
    [50.4500, 30.5236, "Kyiv, Ukraine"],
    [14.6333, 121.0333, "Quezon City, Philippines"],
    [15.3500, 44.2000, "Sanaa, Yemen"],
    [30.0575, 103.8381, "Meishan, China"],
    [14.6099, -90.5252, "Guatemala City, Guatemala"],
    [37.4639, 126.6486, "Incheon, South Korea"],
    [26.6617, 119.5228, "Ningde, China"],
    [27.9942, -82.4451, "Tampa, United States"],
    [46.5979, 125.0080, "Daqing, China"],
    [25.4394, 119.0103, "Putian, China"],
    [-12.9708, -38.5108, "Salvador, Brazil"],
    [-7.2458, 112.7378, "Surabaya, Indonesia"],
    [39.7621, -104.8759, "Denver, United States"],
    [-6.9500, 107.5667, "Bandung, Indonesia"],
    [41.8931, 12.4828, "Rome, Italy"],
    [-16.4942, -68.1475, "La Paz, Bolivia"],
    [40.8151, 111.6629, "Hohhot, China"],
    [27.8431, 112.9228, "Xiangtan, China"],
    [39.0300, 125.7300, "Pyongyang, North Korea"],
    [37.5000, 122.1000, "Weihai, China"],
    [24.1500, 120.6667, "Taichung, Taiwan"],
    [35.4164, 119.4331, "Rizhao, China"],
    [44.5861, 129.5997, "Mudanjiang, China"],
    [22.6167, 120.3000, "Kaohsiung, Taiwan"],
    [-2.1900, -79.8875, "Guayaquil, Ecuador"],
    [42.2841, 123.8365, "Tieling, China"],
    [26.4725, 80.3311, "Cawnpore, India"],
    [35.5806, 104.6263, "Dingxi, China"],
    [26.6448, 118.1728, "Nanping, China"],
    [25.0478, 121.5319, "Taipei, Taiwan"],
    [29.3498, 104.7645, "Zigong, China"],
    [23.6700, 116.6300, "Chaozhou, China"],
    [40.6562, 109.8345, "Baotou, China"],
    [25.0881, 117.0244, "Longyan, China"],
    [32.6877, 109.0235, "Ankang, China"],
    [25.1211, 99.1690, "Baoshan, China"],
    [40.7094, 120.8378, "Huludao, China"],
    [-18.9386, 47.5214, "Antananarivo, Madagascar"],
    [26.0819, 119.2981, "Gulou, China"],
    [30.1256, 104.6397, "Yanjiang, China"],
    [18.4764, -69.8933, "Santo Domingo, Dominican Republic"],
    [22.3350, 91.8325, "Chattogram, Bangladesh"],
    [26.2658, 117.6302, "Sanming, China"],
    [33.5350, 105.3490, "Longba, China"],
    [40.6501, -73.9496, "Brooklyn, United States"],
    [21.8556, 111.9627, "Yangjiang, China"],
    [46.8081, 130.3653, "Jiamusi, China"],
    [7.3964, 3.9167, "Ibadan, Nigeria"],
    [33.5830, 114.0109, "Luohe, China"],
    [23.8864, 100.0871, "Lincang, China"],
    [30.9475, 118.7518, "Xuanzhou, China"],
    [6.2447, -75.5748, "Medellín, Colombia"],
    [22.9242, 112.0353, "Yunfu, China"],
    [25.2697, 55.3094, "Dubai, United Arab Emirates"],
    [41.3000, 69.2667, "Tashkent, Uzbekistan"],
    [25.1500, 82.5800, "Mirzāpur, India"],
    [32.4353, 105.8398, "Guangyuan, China"],
    [30.2018, 115.0326, "Huangshi, China"],
    [3.4400, -76.5197, "Cali, Colombia"],
    [35.8667, 128.6000, "Daegu, South Korea"],
    [12.3686, -1.5275, "Ouagadougou, Burkina Faso"],
    [-3.7275, -38.5275, "Fortaleza, Brazil"],
    [4.0500, 9.7000, "Douala, Cameroon"],
    [40.1167, 124.3833, "Dandong, China"],
    [3.8578, 11.5181, "Yaoundé, Cameroon"],
    [40.6653, 122.2297, "Yingkou, China"],
    [40.7523, 120.8280, "Lianshan, China"],
    [21.1539, 79.0831, "Nāgpur, India"],
    [43.8519, 126.5481, "Jilin, China"],
    [15.6167, 32.4800, "Omdurman, Sudan"],
    [24.3495, 102.5432, "Yuxi, China"],
    [-6.2333, 107.0000, "Bekasi, Indonesia"],
    [28.6667, 77.4167, "Ghāziābād, India"],
    [-27.4678, 153.0281, "Brisbane, Australia"],
    [26.2456, 105.9340, "Anshun, China"],
    [33.8680, 109.9244, "Shangzhou, China"],
    [32.4831, 117.0164, "Huainan, China"],
    [-6.3940, 106.8225, "Depok, Indonesia"],
    [41.7302, 125.9471, "Kuaidamao, China"],
    [5.6037, -0.1870, "Accra, Ghana"],
    [33.6000, 130.4167, "Fukuoka, Japan"],
    [35.4906, 112.8483, "Jincheng, China"],
    [49.2500, -123.1000, "Vancouver, Canada"],
    [-6.1783, 106.6319, "Tangerang, Indonesia"],
    [34.7736, 111.1950, "Sanmenxia, China"],
    [23.7333, 109.2333, "Laibin, China"],
    [40.7498, -73.7976, "Queens, United States"],
    [35.7278, 107.6400, "Qinbaling, China"],
    [36.6239, 101.7787, "Xining, China"],
    [31.6858, 118.5101, "Ma’anshan, China"],
    [36.5952, 109.4863, "Yan’an, China"],
    [40.3667, 49.8352, "Baku, Azerbaijan"],
    [30.7824, 106.1281, "Gaoping, China"],
    [-17.8292, 31.0522, "Harare, Zimbabwe"],
    [23.1367, -82.3589, "Havana, Cuba"],
    [11.5696, 104.9210, "Phnom Penh, Cambodia"],
    [29.8750, 121.5492, "Ningbo, China"],
    [2.0408, 45.3425, "Mogadishu, Somalia"],
    [23.2993, 116.1586, "Puning, China"],
    [33.9562, 116.7890, "Huaibei, China"],
    [24.8141, 118.5792, "Qingyang, China"],
    [3.6667, 98.6667, "Medan, Indonesia"],
    [33.9381, -117.3948, "Riverside, United States"],
    [39.3051, -76.6144, "Baltimore, United States"],
    [36.2333, -115.2654, "Las Vegas, United States"],
    [20.8000, 106.6667, "Haiphong, Vietnam"],
    [22.4167, 107.3667, "Chongzuo, China"],
    [33.6007, 73.0679, "Rawalpindi, Pakistan"],
    [45.5372, -122.6500, "Portland, United States"],
    [24.4164, 111.5478, "Hezhou, China"],
    [6.6833, -1.6167, "Kumasi, Ghana"],
    [35.5412, 106.6819, "Pingliang, China"],
    [22.3000, 73.2000, "Vadodara, India"],
    [29.4658, -98.5253, "San Antonio, United States"],
    [-31.9522, 115.8589, "Perth, Australia"],
    [17.7333, 83.3167, "Vishākhapatnam, India"],
    [37.4500, 118.4667, "Shengli, China"],
    [45.6148, 122.8320, "Baicheng, China"],
    [32.1500, 74.1833, "Gujranwala, Pakistan"],
    [38.6358, -90.2451, "St. Louis, United States"],
    [41.8708, 123.8917, "Fushun, China"],
    [-0.2200, -78.5125, "Quito, Ecuador"],
    [53.9022, 27.5618, "Minsk, Belarus"],
    [12.6458, -7.9922, "Bamako, Mali"],
    [22.7206, 75.8472, "Indore, India"],
    [38.4795, 106.2254, "Yinchuan, China"],
    [-5.8961, 22.4167, "Kananga, Congo (Kinshasa)"],
    [34.0000, 71.5000, "Peshawar, Pakistan"],
    [43.0621, 141.3544, "Sapporo, Japan"],
    [32.6447, 51.6675, "Eşfahān, Iran"],
    [10.5000, -66.9333, "Caracas, Venezuela"],
    [27.6333, 113.8500, "Pingxiang, China"],
    [32.5250, -117.0333, "Tijuana, Mexico"],
    [43.2500, 76.9000, "Almaty, Kazakhstan"],
    [36.2000, 37.1500, "Aleppo, Syria"],
    [48.2083, 16.3725, "Vienna, Austria"],
    [38.5667, -121.4683, "Sacramento, United States"],
    [-15.7861, 35.0058, "Blantyre, Malawi"],
    [22.2769, 113.5678, "Zhuhai, China"],
    [19.1800, 72.9633, "Thāne, India"],
    [22.9833, 120.1833, "Tainan, Taiwan"],
    [44.4000, 26.0833, "Bucharest, Romania"],
    [-25.4297, -49.2719, "Curitiba, Brazil"],
    [40.0820, 113.2981, "Xiping, China"],
    [30.1978, 71.4711, "Multan, Pakistan"],
    [45.2937, 130.9650, "Jixi, China"],
    [34.7500, 72.3572, "Saidu Sharif, Pakistan"],
    [41.2643, 123.1772, "Liaoyang, China"],
    [19.6097, -99.0600, "Ecatepec, Mexico"],
    [53.5500, 10.0000, "Hamburg, Germany"],
    [0.0500, 37.6500, "Meru, Kenya"],
    [-4.2667, 15.2833, "Brazzaville, Congo (Brazzaville)"],
    [28.4772, -81.3369, "Orlando, United States"],
    [42.0127, 121.6486, "Fuxin, China"],
    [37.9278, 102.6329, "Wuwei, China"],
    [-3.1000, -60.0167, "Manaus, Brazil"],
    [23.2500, 77.4167, "Bhopāl, India"],
    [37.3019, -121.8486, "San Jose, United States"],
    [52.2300, 21.0111, "Warsaw, Poland"],
    [-11.6697, 27.4581, "Lubumbashi, Congo (Kinshasa)"],
    [7.0667, 125.6000, "Davao, Philippines"],
    [20.0200, 110.3200, "Haikou, China"],
    [34.1299, 118.7734, "Shuyangzha, China"],
    [33.5131, 36.2919, "Damascus, Syria"],
    [50.8353, 4.3314, "Brussels, Belgium"],
    [-15.4167, 28.2833, "Lusaka, Zambia"],
    [25.3792, 68.3683, "Hyderabad City, Pakistan"],
    [47.4983, 19.0408, "Budapest, Hungary"],
    [39.3408, 112.4292, "Shuozhou, China"],
    [41.4767, -81.6804, "Cleveland, United States"],
    [41.2920, 123.7610, "Benxi, China"],
    [36.5448, 104.1766, "Baiyin, China"],
    [40.4396, -79.9762, "Pittsburgh, United States"],
    [36.3667, 43.1167, "Mosul, Iraq"],
    [30.3004, -97.7522, "Austin, United States"],
    [25.6100, 85.1414, "Patna, India"],
    [30.8200, 108.4000, "Sanzhou, China"],
    [21.4667, 109.1000, "Beihai, China"],
    [21.4225, 39.8261, "Mecca, Saudi Arabia"],
    [50.2458, 127.4886, "Heihe, China"],
    [29.2942, 117.2036, "Jingdezhen, China"],
    [9.5380, -13.6773, "Conakry, Guinea"],
    [39.1413, -84.5061, "Cincinnati, United States"],
    [14.6500, 120.9667, "Caloocan City, Philippines"],
    [0.3136, 32.5811, "Kampala, Uganda"],
    [-8.0539, -34.8808, "Recife, Brazil"],
    [31.3867, 120.9766, "Yushan, China"],
    [39.1239, -94.5541, "Kansas City, United States"],
    [24.9650, 121.2168, "Zhongli, Taiwan"],
    [40.7834, -73.9662, "Manhattan, United States"],
    [22.1500, 82.0167, "Bilāspur, India"],
    [-6.9667, 110.4167, "Semarang, Indonesia"],
    [30.9083, 75.8486, "Ludhiāna, India"],
    [35.0833, 117.1500, "Chengtangcun, China"],
    [55.0333, 82.9167, "Novosibirsk, Russia"],
    [35.8327, 50.9915, "Karaj, Iran"],
    [27.1724, 78.0131, "Āgra, India"],
    [39.7771, -86.1458, "Indianapolis, United States"],
    [27.9991, 120.6561, "Wenzhou, China"],
    [21.1167, -101.6833, "León de los Aldama, Mexico"],
    [19.2502, 73.1602, "Kalyān, India"],
    [19.0333, -98.1833, "Puebla, Mexico"],
    [35.7497, 114.2887, "Hebi, China"],
    [29.6100, 52.5425, "Shīrāz, Iran"],
    [39.9862, -82.9850, "Columbus, United States"],
    [9.9197, 78.1194, "Madurai, India"],
    [-6.1209, 23.5967, "Mbuji-Mayi, Congo (Kinshasa)"],
    [38.0833, 46.2833, "Tabrīz, Iran"],
    [22.8000, 86.1833, "Jamshedpur, India"],
    [10.6333, -71.6333, "Maracaibo, Venezuela"],
    [35.5167, 139.7000, "Kawasaki, Japan"],
    [29.1255, 110.4844, "Zhangjiajie, China"],
    [-2.9833, 104.7644, "Palembang, Indonesia"],
    [5.1167, 7.3667, "Aba, Nigeria"],
    [34.6913, 135.1830, "Kōbe, Japan"],
    [35.2080, -80.8304, "Charlotte, United States"],
    [31.6500, 120.7333, "Changshu, China"],
    [21.6146, 110.2794, "Lianjiang, China"],
    [24.9633, 118.3811, "Ximeicun, China"],
    [28.1958, 115.7833, "Jianguang, China"],
    [29.9888, 103.0007, "Yucheng, China"],
    [-1.4558, -48.5039, "Belém, Brazil"],
    [23.4000, 110.0833, "Guiping, China"],
    [20.9147, 110.0806, "Leizhou, China"],
    [35.1667, 126.9167, "Gwangju, South Korea"],
    [48.1375, 11.5750, "Munich, Germany"],
    [20.0000, 73.7833, "Nāsik, India"],
    [-30.0328, -51.2300, "Porto Alegre, Brazil"],
    [10.1667, -68.0000, "Valencia, Venezuela"],
    [6.1667, 6.7833, "Onitsha, Nigeria"],
    [24.4511, 54.3969, "Abu Dhabi, United Arab Emirates"],
    [36.7335, -76.0435, "Virginia Beach, United States"],
    [20.7167, -103.4000, "Zapopan, Mexico"],
    [36.3510, 127.3850, "Daejeon, South Korea"],
    [56.8356, 60.6128, "Yekaterinburg, Russia"],
    [32.6832, 112.0790, "Huazhou, China"],
    [35.0117, 135.7683, "Kyōto, Japan"],
    [46.6388, 131.1545, "Shuangyashan, China"],
    [34.3422, 118.0097, "Pizhou, China"],
    [32.0500, -7.4000, "El Kelaa des Srarhna, Morocco"],
    [50.0000, 36.2292, "Kharkiv, Ukraine"],
    [31.8775, 120.5512, "Yangshe, China"],
    [36.0080, 106.2782, "Guyuan, China"]*/
  ];


  const databases = new Databases(client);
  const dbID = '686017f10026f1f03f14';
  const collID = ID.unique();
  await databases.createCollection(dbID, collID, Date.now());

  const fetchWeatherAndStore = async ([lat, lon]) => {
    const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${key}`);
    const json = await response.json();
    const documentData = {
      location: json.main?.name,
      temp: json.main?.temp,
      humidity: json.main?.humidity,
      weather: json.weather?.[0]?.description,
    };
    return databases.createDocument(dbID, collID, ID.unique(), documentData);
  };

  await Promise.all(locations.map(fetchWeatherAndStore));
  res.send('done');
}